(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[951],{151:(e,t,a)=>{"use strict";a.d(t,{H:()=>r});let r="https://matrimonial-backend-7ahc.onrender.com"},385:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/profileDetails",function(){return a(8374)}])},7814:(e,t,a)=>{"use strict";a.d(t,{G1:()=>o,Ol:()=>n,cH:()=>l});var r=a(2692);let s=null;function l(e){return s&&s.connected||((s=(0,r.io)("https://matrimonial-backend-7ahc.onrender.com",{transports:["websocket"],secure:!0,reconnection:!0,reconnectionAttempts:10,path:"/socket.io",query:{adminId:e}})).on("connect",()=>{console.log("\uD83D\uDD35 SOCKET CONNECTED:",s.id)}),s.on("disconnect",()=>{console.log("\uD83D\uDD34 SOCKET DISCONNECTED")})),s}function o(){s&&(s.disconnect(),console.log("\uD83D\uDD34 SOCKET MANUALLY DISCONNECTED"))}function n(){return s}},8374:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>m});var r=a(7876),s=a(4232),l=a(9516),o=a(7814);let n=e=>{let{onSearch:t}=e,[a,n]=(0,s.useState)(""),[i,c]=(0,s.useState)([]),[d,u]=(0,s.useState)(0),[m,h]=(0,s.useState)(!1),x=(0,s.useRef)(null),p="https://matrimonial-backend-7ahc.onrender.com",f=async()=>{try{let e=localStorage.getItem("token"),t=await fetch("".concat(p,"/admin/profile"),{headers:{Authorization:"Bearer ".concat(e)}}),a=await t.json();if(a.success){let e=a.data;!0===e.notifications?(0,o.cH)(e._id):(0,o.G1)()}}catch(e){console.log("Admin Pref error:",e)}};(0,s.useEffect)(()=>{f()},[]);let g=async()=>{try{let e=localStorage.getItem("token"),t=await fetch("".concat(p,"/api/notification/me"),{headers:{Authorization:"Bearer ".concat(e)}}),a=await t.json();if(a.success){let e=a.data.reverse();c(e),u(e.filter(e=>!e.read).length)}}catch(e){console.log("Fetch Notification Error:",e)}};(0,s.useEffect)(()=>{g()},[]),(0,s.useEffect)(()=>{let e=(0,o.Ol)();if(e)return console.log("\uD83D\uDFE2 Profile Topbar â€” Real-time listener active"),e.on("new-notification",e=>{console.log("\uD83D\uDD14 REAL-TIME NOTIFICATION:",e),c(t=>[e,...t]),u(e=>e+1)}),()=>{let e=(0,o.Ol)();e&&e.off("new-notification")}},[]);let b=()=>t(a.toLowerCase());(0,s.useEffect)(()=>{let e=e=>{x.current&&!x.current.contains(e.target)&&h(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let w=async e=>{let t=localStorage.getItem("token");await fetch("".concat(p,"/api/notification/mark-read/").concat(e),{method:"PATCH",headers:{Authorization:"Bearer ".concat(t)}}),c(t=>t.map(t=>t._id===e?{...t,read:!0}:t)),u(e=>e-1)},j=async()=>{let e=localStorage.getItem("token");await fetch("".concat(p,"/api/notification/mark-all"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(e)}}),c(e=>e.map(e=>({...e,read:!0}))),u(0)},v=async e=>{let t=localStorage.getItem("token");await fetch("".concat(p,"/api/notification/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}}),c(t=>t.filter(t=>t._id!==e))},y=async()=>{let e=localStorage.getItem("token");await Promise.all(i.map(t=>fetch("".concat(p,"/api/notification/").concat(t._id),{method:"DELETE",headers:{Authorization:"Bearer ".concat(e)}}))),c([]),u(0)};return(0,r.jsx)("div",{className:"border-slate-700 w-full bg-[rgba(242,242,242,1)] p-2",children:(0,r.jsxs)("div",{className:"flex justify-between items-center fixed top-0 right-[14px] border-b-2 w-[1272px] bg-[rgba(242,242,242,1)] p-3 shadow z-50",children:[(0,r.jsx)("h1",{className:"text-xl text-black font-semibold",children:"Profile Details"}),(0,r.jsxs)("div",{className:"flex gap-5 items-center",children:[(0,r.jsxs)("div",{className:"flex items-center bg-white border border-gray-300 rounded-full px-4 py-2 w-[350px] shadow-sm",children:[(0,r.jsx)(l.A,{className:"text-gray-600 cursor-pointer",size:18,onClick:b}),(0,r.jsx)("input",{type:"text",placeholder:"Search...",className:"ml-2 w-full outline-none text-sm bg-transparent",value:a,onChange:e=>{n(e.target.value),t(e.target.value.toLowerCase())},onKeyDown:e=>"Enter"===e.key&&b()})]}),(0,r.jsxs)("div",{className:"relative",ref:x,children:[(0,r.jsx)("svg",{onClick:()=>{let e=!m;h(e),e&&(u(0),c(e=>e.map(e=>({...e,read:!0}))))},xmlns:"http://www.w3.org/2000/svg",width:"30",height:"30",fill:"#FFC107",viewBox:"0 0 24 24",className:"cursor-pointer",children:(0,r.jsx)("path",{d:"M12 24c1.104 0 2-.897 2-2h-4c0 1.103.896 2 2 2zm6.707-5l1.293 1.293V21H4v-1.707L5.293 19H6v-7c0-3.309 2.691-6 6-6s6 2.691 6 6v7h.707zM18 18H6v-7c0-2.757 2.243-5 5-5s5 2.243 5 5v7z"})}),d>0&&(0,r.jsx)("span",{className:"absolute -top-1 -right-1 h-4 w-4 bg-red-600 text-white text-[10px] flex items-center justify-center rounded-full border-2 border-white",children:d}),m&&(0,r.jsxs)("div",{className:"absolute right-0 mt-3 w-[330px] bg-white shadow-lg border rounded-lg p-3 z-50",children:[(0,r.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,r.jsx)("h2",{className:"font-semibold",children:"Notifications"}),(0,r.jsx)("button",{onClick:j,className:"text-blue-600 text-sm",children:"Mark all read"})]}),(0,r.jsx)("div",{className:"max-h-[300px] overflow-y-auto",children:0===i.length?(0,r.jsx)("p",{className:"text-center py-3 text-gray-500",children:"No notifications"}):i.map(e=>(0,r.jsxs)("div",{className:"p-3 border-b flex justify-between items-start ".concat(e.read?"":"bg-yellow-50"),children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold",children:e.title}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:e.message}),(0,r.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:new Date(e.createdAt).toLocaleString()}),!e.read&&(0,r.jsx)("button",{onClick:()=>w(e._id),className:"text-blue-600 text-xs mt-1",children:"Mark as read"})]}),(0,r.jsx)("button",{onClick:()=>v(e._id),className:"text-red-500 text-xs",children:"Delete"})]},e._id))}),i.length>0&&(0,r.jsx)("button",{onClick:y,className:"w-full mt-2 py-2 text-red-600 text-sm border-t",children:"Delete All"})]})]})]})]})})};var i=a(151),c=a(2990);let d=e=>{let{title:t,apiPath:a}=e,[l,o]=(0,s.useState)(""),[n,d]=(0,s.useState)(""),[u,m]=(0,s.useState)([]),[h,x]=(0,s.useState)([]),[p,f]=(0,s.useState)(null),[g,b]=(0,s.useState)(""),[w,j]=(0,s.useState)(""),[v,y]=(0,s.useState)(""),N="".concat(i.H,"/api/master/").concat(a);(0,s.useEffect)(()=>{E(),"city"===a&&C()},[]);let E=async()=>{try{let e=await fetch(N),t=await e.json();x(t)}catch(e){console.error("Error fetching options:",e)}},C=async()=>{try{let e=await fetch("".concat(i.H,"/api/master/state")),t=await e.json();m(t)}catch(e){console.error("Error fetching states:",e)}},k=async()=>{let e=l.trim();if(!e)return;if(h.some(t=>t.value.trim().toLowerCase()===e.toLowerCase()))return void y("This field has already been mentioned");let t="city"===a?{value:e,state:n}:{value:e};try{let e=await fetch(N,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),a=await e.json();x(e=>[...e,a]),o(""),d(""),y("")}catch(e){console.error("Error adding option:",e)}},S=async e=>{try{await fetch("".concat(N,"/").concat(e),{method:"DELETE"}),x(t=>t.filter(t=>t._id!==e))}catch(e){console.error("Error deleting option:",e)}};return(0,r.jsxs)("div",{className:"border-1 border-black mt-[50px] p-3 rounded-xl shadow-sm bg-white w-full max-w-md mx-auto transition hover:shadow-md",children:[(0,r.jsx)("h1",{className:"text-xl font-bold text-gray-800 mb-4",children:t}),(0,r.jsxs)("div",{className:"flex flex-col gap-3 mb-3",children:["city"===a&&(0,r.jsxs)("select",{value:n,onChange:e=>d(e.target.value),className:"p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-rose-400",children:[(0,r.jsx)("option",{value:"",children:"Select State"}),u.map(e=>(0,r.jsx)("option",{value:e.value,children:e.value},e._id))]}),(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault(),k()},className:"flex gap-3 flex-row ",children:[(0,r.jsx)("input",{type:"text",value:l,onChange:e=>{o(e.target.value),y("")},onKeyDown:e=>{"Enter"===e.key&&""!==l.trim()&&(e.preventDefault(),k())},placeholder:"Enter new value",className:"w-full p-3 border border-green-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-rose-400"}),v&&(0,r.jsx)("p",{className:"text-sm text-red-500 -mt-2",children:v}),(0,r.jsx)("button",{type:"button",onClick:k,className:"bg-red-800 border-1 border-black   text-white rounded-lg hover:bg-rose-700 px-4 py-2 transition font-medium",children:"Add"})]})]}),h.length>0&&(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:h.map(e=>(0,r.jsx)("div",{className:"",children:p===e._id?(0,r.jsxs)("div",{className:"",children:[(0,r.jsx)("input",{value:g,onChange:e=>b(e.target.value),className:"flex-1 p-2 border border-gray-300 rounded-md"}),"city"===a&&(0,r.jsx)("select",{value:w,onChange:e=>j(e.target.value),className:"p-2 border border-gray-300 rounded-md",children:u.map(e=>(0,r.jsx)("option",{value:e.value,children:e.value},e._id))})]}):(0,r.jsxs)("div",{className:"inline-flex bg-[rgba(255,208,208,1)] items-center gap-2 p-1 justify-center shadow rounded border-1 border-green-400 overflow-hidden text-ellipsis whitespace-nowrap",children:[(0,r.jsxs)("span",{className:"text-gray-800   font-medium",children:[e.value," ",e.state?"(".concat(e.state,")"):""]}),(0,r.jsx)("div",{className:" flex gap-2",children:(0,r.jsx)("button",{onClick:()=>S(e._id),className:"cursor-pointer text-black flex justify-center items-center bg-transparent ",children:(0,r.jsx)(c.j55,{className:"bg-transparent"})})})]})},e._id))})]})},u=[{label:"Profile For",api:"profile-for"},{label:"Religion",api:"religion"},{label:"Caste",api:"caste"},{label:"Communities",api:"communities"},{label:"Diet",api:"diet"},{label:"Color",api:"color"},{label:"Marital Status",api:"marital-status"},{label:"Mother Tongue",api:"mother-tongue"},{label:"Family Status",api:"family-status"},{label:"State",api:"state"},{label:"City",api:"city"},{label:"Education",api:"education"},{label:"Employed In",api:"employed-in"},{label:"Designation",api:"designation"}];function m(){let[e,t]=(0,s.useState)(""),a=u.filter(t=>t.label.toLowerCase().includes(e));return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n,{onSearch:t}),(0,r.jsx)("div",{className:"min-h-screen bg-gray-100 p-8 mt-[10px]",children:(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.length>0?a.map((e,t)=>(0,r.jsx)(d,{title:e.label,apiPath:e.api},t)):(0,r.jsx)("p",{className:"text-center text-gray-500 col-span-3",children:"No matching results..."})})})]})}},9516:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(1713).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])}},e=>{e.O(0,[756,692,636,593,792],()=>e(e.s=385)),_N_E=e.O()}]);