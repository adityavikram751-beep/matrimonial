(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[748],{151:(e,t,r)=>{"use strict";r.d(t,{H:()=>s});let s="https://matrimonial-backend-7ahc.onrender.com"},3703:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/reportedcontent",function(){return r(8256)}])},8256:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u});var s=r(7876),a=r(4232),l=r(2577);let c=()=>{let[e,t]=(0,a.useState)([]),[r,c]=(0,a.useState)(!1),n=(0,a.useRef)(null),o="https://matrimonial-backend-7ahc.onrender.com";(0,a.useEffect)(()=>{let e=e=>{n.current&&!n.current.contains(e.target)&&c(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let i=async()=>{try{let e=localStorage.getItem("token"),r=await fetch("".concat(o,"/api/notification/me"),{headers:{Authorization:"Bearer ".concat(e)}}),s=await r.json();s.success&&t(s.data.reverse())}catch(e){console.log("Fetch Notification Error:",e)}};(0,a.useEffect)(()=>{i()},[]);let d=async e=>{try{let r=localStorage.getItem("token");await fetch("".concat(o,"/api/notification/mark-read/").concat(e),{method:"PATCH",headers:{Authorization:"Bearer ".concat(r)}}),t(t=>t.map(t=>t._id===e?{...t,read:!0}:t))}catch(e){console.log("Mark Read Error:",e)}},x=async()=>{try{let e=localStorage.getItem("token");await fetch("".concat(o,"/api/notification/mark-all"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(e)}}),t(e=>e.map(e=>({...e,read:!0})))}catch(e){console.log("Mark All Error:",e)}},m=async e=>{try{let r=localStorage.getItem("token");await fetch("".concat(o,"/api/notification/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(r)}}),t(t=>t.filter(t=>t._id!==e))}catch(e){console.log("Delete Error:",e)}},p=async()=>{try{let r=localStorage.getItem("token");await Promise.all(e.map(e=>fetch("".concat(o,"/api/notification/").concat(e._id),{method:"DELETE",headers:{Authorization:"Bearer ".concat(r)}}))),t([])}catch(e){console.log("Delete All Error:",e)}},h=e.filter(e=>!e.read).length;return(0,s.jsxs)("div",{className:"w-full bg-[#f5f5f5] py-3 px-4 border-b flex items-center justify-between",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-black whitespace-nowrap",children:"Reported Content"}),(0,s.jsx)("div",{className:"flex items-center gap-4",children:(0,s.jsxs)("div",{className:"relative",ref:n,children:[(0,s.jsxs)("div",{className:"cursor-pointer relative",onClick:()=>c(!r),children:[(0,s.jsx)(l.A,{className:"h-7 w-7 text-yellow-500"}),h>0&&(0,s.jsx)("span",{className:"absolute -top-1 -right-1 h-4 w-4 bg-red-600 text-white text-[10px] flex items-center justify-center rounded-full border-2 border-white",children:h})]}),r&&(0,s.jsxs)("div",{className:"absolute right-0 mt-3 w-[330px] bg-white shadow-lg border rounded-lg p-3 z-50",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,s.jsx)("h2",{className:"font-semibold text-gray-800",children:"Notifications"}),(0,s.jsx)("button",{onClick:x,className:"text-blue-600 text-sm",children:"Mark all read"})]}),(0,s.jsx)("div",{className:"max-h-[300px] overflow-y-auto",children:0===e.length?(0,s.jsx)("p",{className:"text-center text-gray-500 py-3",children:"No notifications"}):e.map(e=>(0,s.jsxs)("div",{className:"p-3 border-b flex justify-between items-start ".concat(e.read?"":"bg-yellow-50"),children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-semibold",children:e.title}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:e.message}),(0,s.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:new Date(e.createdAt).toLocaleString()}),!e.read&&(0,s.jsx)("button",{onClick:()=>d(e._id),className:"text-blue-600 text-xs mt-1",children:"Mark as read"})]}),(0,s.jsx)("button",{onClick:()=>m(e._id),className:"text-red-500 text-sm",children:"Delete"})]},e._id))}),e.length>0&&(0,s.jsx)("button",{className:"w-full text-red-600 mt-2 py-2 text-sm border-t",onClick:p,children:"Delete All"})]})]})})]})};var n=r(9516),o=r(4250),i=r.n(o),d=r(151);let x=e=>{let{report:t,onClose:r,refreshReports:a}=e;if(!t)return null;let{reporter:l,reportedUser:c,title:n,description:o,image:x,status:m,createdAt:p}=t,h=async e=>{try{let s=await fetch("".concat(d.H,"/admin/report/status/").concat(t._id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"approve"===e?"approved":"rejected"})}),l=await s.json();console.log("API Response:",l),l.success?(alert("Report has been ".concat("approve"===e?"approved":"rejected")),r(),a()):alert(l.message||"Something went wrong")}catch(e){console.error("Error in handleAction:",e),alert("Error processing action")}};return(0,s.jsxs)("div",{id:"backdrop",onClick:e=>{"backdrop"===e.target.id&&r()},className:"jsx-335342c2f5390679 fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm px-4 py-10",children:[(0,s.jsxs)("div",{onClick:e=>e.stopPropagation(),className:"jsx-335342c2f5390679 relative bg-white/90 backdrop-blur-lg border border-white/40 rounded-3xl shadow-2xl max-w-xl w-full p-8 animate-scaleIn",children:[(0,s.jsxs)("div",{className:"jsx-335342c2f5390679 flex justify-between items-center mb-6",children:[(0,s.jsxs)("div",{className:"jsx-335342c2f5390679 flex items-center gap-2",children:[(0,s.jsx)("div",{className:"jsx-335342c2f5390679 "+"w-3 h-3 rounded-full ".concat("rejected"===m?"bg-red-500":"approved"===m?"bg-green-500":"bg-yellow-400")}),(0,s.jsx)("span",{className:"jsx-335342c2f5390679 text-sm font-medium capitalize text-gray-800",children:m})]}),(0,s.jsxs)("span",{className:"jsx-335342c2f5390679 text-sm text-gray-600",children:["Reported on: ",new Date(p).toLocaleDateString()]})]}),(0,s.jsx)("div",{className:"jsx-335342c2f5390679 grid grid-cols-1 sm:grid-cols-2 gap-6 mb-6",children:[c,l].map((e,t)=>(0,s.jsxs)("div",{className:"jsx-335342c2f5390679 bg-white rounded-xl border border-gray-200 p-5 flex flex-col items-center text-center hover:shadow-md transition",children:[(0,s.jsx)("img",{src:(null==e?void 0:e.avatar)||(null==e?void 0:e.profileImage)||"/default-profile.png",alt:"User",className:"jsx-335342c2f5390679 w-20 h-20 rounded-full border object-cover shadow"}),(0,s.jsx)("h3",{className:"jsx-335342c2f5390679 font-semibold text-lg text-gray-800 mt-3",children:(null==e?void 0:e.name)||(null==e?void 0:e.fullName)||"Unnamed User"}),(0,s.jsx)("p",{className:"jsx-335342c2f5390679 text-xs text-blue-500 mt-1",children:1===t?"Reporter":"Reported User"})]},t))}),(0,s.jsxs)("div",{className:"jsx-335342c2f5390679 mb-4",children:[(0,s.jsx)("h4",{className:"jsx-335342c2f5390679 font-semibold text-base mb-1",children:"Reason:"}),(0,s.jsx)("p",{className:"jsx-335342c2f5390679 text-sm text-gray-700 leading-relaxed bg-gray-100 border border-gray-200 rounded-lg p-4 mt-1",children:n}),(0,s.jsx)("h4",{className:"jsx-335342c2f5390679 font-semibold text-base mb-1 mt-4",children:"Description:"}),(0,s.jsx)("p",{className:"jsx-335342c2f5390679 text-sm text-gray-700 leading-relaxed bg-gray-100 border border-gray-200 rounded-lg p-4 mt-1",children:o})]}),(null==x?void 0:x.length)>0&&(0,s.jsxs)("div",{className:"jsx-335342c2f5390679 mb-4",children:[(0,s.jsxs)("h4",{className:"jsx-335342c2f5390679 text-sm font-semibold text-gray-800 mb-2",children:["Attached Screenshot",x.length>1?"s":"",":"]}),(0,s.jsx)("div",{className:"jsx-335342c2f5390679 flex flex-wrap gap-2",children:x.map((e,t)=>(0,s.jsxs)("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"jsx-335342c2f5390679 text-sm text-blue-600 bg-blue-100 hover:bg-blue-200 px-3 py-1 rounded-md transition",children:["\uD83D\uDCCE Screenshot_",t+1,".jpg"]},t))})]}),(0,s.jsxs)("div",{className:"jsx-335342c2f5390679 flex justify-end gap-4 mt-8",children:[(0,s.jsx)("button",{onClick:()=>h("approve"),className:"jsx-335342c2f5390679 bg-green-500 hover:bg-green-600 text-white px-5 py-2 rounded-full font-semibold shadow",children:"Approve"}),(0,s.jsx)("button",{onClick:()=>h("reject"),className:"jsx-335342c2f5390679 bg-red-500 hover:bg-red-600 text-white px-5 py-2 rounded-full font-semibold shadow",children:"Reject"})]})]}),(0,s.jsx)(i(),{id:"335342c2f5390679",children:".animate-scaleIn.jsx-335342c2f5390679{animation:scaleIn.3s ease-out}@keyframes scaleIn{0%{transform:scale(.95);opacity:0}100%{transform:scale(1);opacity:1}}"})]})},m=e=>{let{active:t,direction:r}=e;return(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center ml-1 mt-[2px] leading-[0.4]",children:[(0,s.jsx)("div",{className:"w-2 h-2 rotate-45 border-t-2 border-l-2 ".concat(t&&"asc"===r?"border-gray-700":"border-gray-400")}),(0,s.jsx)("div",{className:"w-2 h-2 rotate-45 border-b-2 border-r-2 mt-[3px] ".concat(t&&"desc"===r?"border-gray-700":"border-gray-400")})]})},p=e=>{let{report:t,currentPage:r,totalPages:l,setCurrentPage:c,refreshReports:n}=e,[o,i]=(0,a.useState)(null),[d,p]=(0,a.useState)({key:null,direction:"asc"}),h=e=>{p(t=>({key:e,direction:t.key===e&&"asc"===t.direction?"desc":"asc"}))},u=(0,a.useMemo)(()=>d.key?[...t].sort((e,t)=>{var r,s,a,l,c,n,o,i;let x="",m="";switch(d.key){case"reportedUser":x=(null==(r=e.reportedUser)?void 0:r.fullName)||(null==(s=e.reportedUser)?void 0:s.name)||"",m=(null==(a=t.reportedUser)?void 0:a.fullName)||(null==(l=t.reportedUser)?void 0:l.name)||"";break;case"reportDate":x=new Date(e.createdAt),m=new Date(t.createdAt);break;case"reporterUser":x=(null==(c=e.reporter)?void 0:c.fullName)||(null==(n=e.reporter)?void 0:n.name)||"",m=(null==(o=t.reporter)?void 0:o.fullName)||(null==(i=t.reporter)?void 0:i.name)||""}return x<m?"asc"===d.direction?-1:1:x>m?"asc"===d.direction?1:-1:0}):t,[t,d]),g=e=>(null==e?void 0:e.profileImage)||"/default-profile.png",f=e=>(null==e?void 0:e.fullName)||(null==e?void 0:e.name)||"Unknown User",j=e=>(null==e?void 0:e.userId)?"#".concat(e.userId):"#------",b=e=>(null==e?void 0:e.gender)||"N/A";return(0,s.jsxs)("div",{className:"bg-white  px-1",children:[(0,s.jsx)("div",{className:"w-full h-[1px] bg-gray-500 mb-2"}),(0,s.jsxs)("table",{className:"w-full text-sm text-left",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:" border-b border-gray-500",children:[(0,s.jsx)("th",{className:"py-3 px-2 cursor-pointer font-semibold",onClick:()=>h("reportedUser"),children:(0,s.jsxs)("div",{className:"flex items-center gap-1",children:["Reported User",(0,s.jsx)(m,{active:"reportedUser"===d.key,direction:d.direction})]})}),(0,s.jsx)("th",{className:"py-3 px-2 cursor-pointer font-semibold",onClick:()=>h("reportDate"),children:(0,s.jsxs)("div",{className:"flex items-center gap-1",children:["Report Date",(0,s.jsx)(m,{active:"reportDate"===d.key,direction:d.direction})]})}),(0,s.jsx)("th",{className:"py-3 px-2 cursor-pointer font-semibold",onClick:()=>h("reporterUser"),children:(0,s.jsxs)("div",{className:"flex items-center gap-1",children:["Reporter User",(0,s.jsx)(m,{active:"reporterUser"===d.key,direction:d.direction})]})}),(0,s.jsx)("th",{className:"py-3 px-2 font-semibold",children:"Reason"}),(0,s.jsx)("th",{className:"py-3 px-2 font-semibold",children:"Status"}),(0,s.jsx)("th",{className:"py-3 px-2 font-semibold",children:"Actions"})]})}),(0,s.jsx)("tbody",{children:u.map(e=>(0,s.jsxs)("tr",{className:"border-t border-gray-300 hover:bg-gray-50 transition",children:[(0,s.jsx)("td",{className:"py-[14px] px-3 align-middle",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("img",{src:g(e.reportedUser),className:"w-11 h-11 rounded-full object-cover"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-semibold",children:f(e.reportedUser)}),(0,s.jsxs)("div",{className:"text-xs text-gray-500",children:[j(e.reportedUser)," /"," ",b(e.reportedUser)]})]})]})}),(0,s.jsx)("td",{className:"py-[14px] px-3 align-middle",children:new Date(e.createdAt).toLocaleDateString("en-GB",{day:"2-digit",month:"long",year:"numeric"})}),(0,s.jsx)("td",{className:"py-[14px] px-3 align-middle",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("img",{src:g(e.reporter),className:"w-11 h-11 rounded-full object-cover"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-semibold",children:f(e.reporter)}),(0,s.jsxs)("div",{className:"text-xs text-gray-500",children:[j(e.reporter)," / ",b(e.reporter)]})]})]})}),(0,s.jsx)("td",{className:"py-[14px] px-3 align-middle",children:e.title}),(0,s.jsx)("td",{className:"py-[14px] px-3 align-middle",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"w-3 h-3 rounded-full ".concat((e=>"approved"===(e=null==e?void 0:e.toLowerCase())?"bg-green-500":"pending"===e?"bg-yellow-500":"bg-red-500")(e.status))}),(0,s.jsx)("span",{children:e.status})]})}),(0,s.jsx)("td",{className:"py-[14px] px-3 align-middle",children:(0,s.jsx)("div",{className:"flex items-center gap-3",children:(0,s.jsx)("button",{className:"text-gray-700",onClick:()=>i(e),children:"View"})})})]},e._id))})]}),(0,s.jsxs)("div",{className:"flex justify-center items-center gap-3 mt-4 text-sm",children:[(0,s.jsx)("button",{disabled:1===r,onClick:()=>c(r-1),children:"◀ Prev"}),[...Array(l)].map((e,t)=>(0,s.jsx)("button",{onClick:()=>c(t+1),className:"".concat(r===t+1?"font-bold underline":"text-gray-600"),children:t+1},t)),(0,s.jsx)("span",{children:"....."}),(0,s.jsx)("button",{disabled:r===l,onClick:()=>c(r+1),children:"Next ▶"})]}),o&&(0,s.jsx)(x,{report:o,onClose:()=>i(null),refreshReports:n})]})},h=()=>{let[e,t]=(0,a.useState)([]),[r,l]=(0,a.useState)(""),[c,o]=(0,a.useState)("all"),[i,x]=(0,a.useState)(""),[m,h]=(0,a.useState)(1),[u,g]=(0,a.useState)(1),f=async()=>{try{let e=await fetch("".concat(d.H,"/admin/report-analize?search=").concat(r,"&status=").concat(c,"&gender=").concat(i,"&page=").concat(m,"&limit=").concat(10)),s=await e.json();t(s.reports||[]),g(s.totalPages||1)}catch(e){console.error("Failed to fetch reports:",e)}};(0,a.useEffect)(()=>{f()},[r,c,i,m]);let j=e.length,b=e.filter(e=>{var t;return(null==(t=e.status)?void 0:t.toLowerCase())==="pending"}).length,v=e.filter(e=>{var t,r;return(null==(t=e.status)?void 0:t.toLowerCase())==="reviewed"||(null==(r=e.status)?void 0:r.toLowerCase())==="approved"}).length,y=e.filter(e=>{var t;return(null==(t=e.status)?void 0:t.toLowerCase())==="blocked"}).length;return(0,s.jsxs)("div",{className:"p-5",children:[(0,s.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-6 px-10 mb-10",children:[{label:"Total Reports This Week",value:j},{label:"Pending Report Review",value:b},{label:"Action Taken",value:v},{label:"Blocked User",value:y}].map(e=>{let{label:t,value:r}=e;return(0,s.jsxs)("div",{className:"bg-white border border-gray-300 rounded-xl shadow-sm p-6 flex flex-col justify-center items-center",style:{height:"150px"},children:[(0,s.jsx)("p",{className:"text-lg font-semibold text-gray-800 text-center",children:t}),(0,s.jsx)("p",{className:"text-3xl font-bold text-gray-900 mt-4",children:(e=>e>=1e3?(e/1e3).toFixed(1)+" K":e)(r)})]},t)})}),(0,s.jsxs)("div",{className:"border mt-5 p-4 bg-white border-gray-400 rounded",children:[(0,s.jsx)("div",{className:"bg-gray-100 p-2 rounded-lg shadow-sm border border-gray-400 mb-2",children:(0,s.jsxs)("div",{className:" flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,s.jsxs)("div",{className:" relative w-full  md:max-w-sm",children:[(0,s.jsx)(n.A,{className:" absolute left-3 top-1/2 transform -translate-y-1/2  text-gray-400 w-4 h-4"}),(0,s.jsx)("input",{type:"text",placeholder:"Search by name or email",value:r,onChange:e=>{h(1),l(e.target.value)},className:"w-full pl-10 pr-4 py-2  bg-white border  border-gray-400 rounded-lg focus:ring-2 focus:ring-gray-200"})]}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,s.jsxs)("select",{value:c,onChange:e=>{h(1),o(e.target.value)},className:"px-3 py-2 border bg-gray-300 border-gray-400 rounded-lg",children:[(0,s.jsx)("option",{value:"all",children:" Status"}),(0,s.jsx)("option",{value:"pending",children:"Pending"}),(0,s.jsx)("option",{value:"approved",children:"Approved"}),(0,s.jsx)("option",{value:"blocked",children:"Blocked"})]}),(0,s.jsxs)("select",{value:i,onChange:e=>{h(1),x(e.target.value)},className:"px-3 py-2 border bg-gray-300 border-gray-400 rounded-lg",children:[(0,s.jsx)("option",{value:"",children:" Genders"}),(0,s.jsx)("option",{value:"Male",children:"Male"}),(0,s.jsx)("option",{value:"Female",children:"Female"})]})]})]})}),(0,s.jsx)(p,{report:e,currentPage:m,totalPages:u,setCurrentPage:h,itemsPerPage:10,refreshReports:f})]})]})},u=()=>(0,s.jsxs)("div",{className:"h-screen flex flex-col",children:[(0,s.jsx)("div",{className:"shadow-md sticky top-0 z-30 bg-[#f5f5f5]",children:(0,s.jsx)(c,{})}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,s.jsx)(h,{})})]})}},e=>{e.O(0,[151,636,593,792],()=>e(e.s=3703)),_N_E=e.O()}]);